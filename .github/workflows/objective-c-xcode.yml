- name: Build
  env:
    scheme: ${{ env.default }}
  run: |
    if [ "$scheme" = "default" ]; then scheme=$(cat default); fi
    if [ "`ls -A | grep -i \\.xcworkspace\$`" ]; then 
      filetype_parameter="workspace"
      file_to_build="`ls -A | grep -i \\.xcworkspace\$`"
    else
      filetype_parameter="project"
      file_to_build="`ls -A | grep -i \\.xcodeproj\$`"
    fi
    file_to_build=`echo $file_to_build | awk '{$1=$1;print}'`
    destination="platform=macOS,arch=arm64,variant=Designed for [iPad,iPhone],id=0000FE00-DF7000BB548BFB0A"
    xcodebuild clean build analyze -scheme "$scheme" -"$filetype_parameter" "$file_to_build" -destination "$destination" | xcpretty && exit ${PIPESTATUS[0]}
